<Window x:Class="GameAssetBrowser.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:GameAssetBrowser.ViewModels"
        Title="Game Asset Browser" 
        Height="750" Width="1200"
        MinHeight="600" MinWidth="900"
        WindowStartupLocation="CenterScreen"
        Background="#1E1E2E">

    <Window.DataContext>
        <vm:MainViewModel/>
    </Window.DataContext>

    <Window.Resources>

        <SolidColorBrush x:Key="BgPrimary" Color="#1E1E2E"/>
        <SolidColorBrush x:Key="BgSecondary" Color="#2B2B3D"/>
        <SolidColorBrush x:Key="BgTertiary" Color="#363650"/>
        <SolidColorBrush x:Key="AccentBlue" Color="#7AA2F7"/>
        <SolidColorBrush x:Key="AccentGreen" Color="#9ECE6A"/>
        <SolidColorBrush x:Key="AccentOrange" Color="#FF9E64"/>
        <SolidColorBrush x:Key="AccentPurple" Color="#BB9AF7"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#C0CAF5"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#565F89"/>
        <SolidColorBrush x:Key="BorderColor" Color="#3B3B54"/>

        <!-- for hiding/showing the panels -->
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <!-- style work for the stat cards - still a work in progress need to work on it and make it better -->
        <Style x:Key="StatCard" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource BgSecondary}"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="4"/>
        </Style>

        <!-- Style for the buttons -->
        <Style x:Key="ToolButton" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource BgTertiary}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource BorderColor}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="6" Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{StaticResource AccentBlue}"/>
                                <Setter Property="Foreground" Value="#1E1E2E"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- toolbar -->
            <RowDefinition Height="Auto"/>
            <!-- stats bar -->
            <RowDefinition Height="*"/>
            <!-- main content -->
            <RowDefinition Height="Auto"/>
            <!-- status bar -->
        </Grid.RowDefinitions>

        <!-- top toolbar section -->
        <Border Grid.Row="0" Background="{StaticResource BgSecondary}" 
                BorderBrush="{StaticResource BorderColor}" BorderThickness="0,0,0,1"
                Padding="12,10">
            <Grid Height="35" VerticalAlignment="Bottom">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- app title and the browse button section -->
                <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="🎮" FontSize="22" VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBlock Text="Game Asset Browser" FontSize="18" FontWeight="SemiBold" 
                               Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"
                               Margin="0,0,16,0"/>
                    <Button Content="📁 Open Folder" Command="{Binding BrowseFolderCommand}" 
                            Style="{StaticResource ToolButton}"/>
                </StackPanel>

                <!-- search bar section -->
                <Border Grid.Column="1" Background="{StaticResource BgTertiary}" 
                        CornerRadius="6" Margin="16,0" Padding="4">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="🔍" FontSize="14" 
                                   VerticalAlignment="Center" Margin="8,0"/>
                        <TextBox Grid.Column="1" Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                 Background="Transparent" BorderThickness="0" 
                                 Foreground="{StaticResource TextPrimary}" FontSize="14"
                                 VerticalAlignment="Center" Padding="4"
                                 CaretBrush="{StaticResource TextPrimary}"/>
                        <Button Grid.Column="2" Content="✕" Command="{Binding ClearSearchCommand}"
                                Background="Transparent" BorderThickness="0"
                                Foreground="{StaticResource TextSecondary}" Cursor="Hand"
                                FontSize="14" Padding="8,4" VerticalAlignment="Center"/>
                    </Grid>
                </Border>

                <!-- modifying this for the filter controls section -->
                <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                    <TextBlock Text="Category:" Foreground="{StaticResource TextSecondary}" 
                               VerticalAlignment="Center" Margin="0,0,6,0" FontSize="12"/>
                    <ComboBox ItemsSource="{Binding AvailableCategories}" 
                              SelectedItem="{Binding SelectedCategory}"
                              Width="100" FontSize="12" Margin="0,0,12,0"/>

                    <TextBlock Text="Sort:" Foreground="{StaticResource TextSecondary}" 
                               VerticalAlignment="Center" Margin="0,0,6,0" FontSize="12"/>
                    <ComboBox ItemsSource="{Binding SortOptions}" 
                              SelectedItem="{Binding SelectedSort}"
                              Width="130" FontSize="12" Margin="0,0,12,0"/>

                    <Button Content="Clear Filters" Command="{Binding ClearFiltersCommand}"
                            Style="{StaticResource ToolButton}" FontSize="11" Padding="10,6"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- stats bar section -->
        <Border Grid.Row="1" Background="{StaticResource BgPrimary}" Padding="8,4">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center">
                <Border Style="{StaticResource StatCard}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="📦" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding TotalAssetCount}" FontWeight="Bold" FontSize="16"
                                   Foreground="{StaticResource AccentBlue}" VerticalAlignment="Center"/>
                        <TextBlock Text=" Assets" Foreground="{StaticResource TextSecondary}" 
                                   FontSize="12" VerticalAlignment="Center" Margin="4,0,0,0"/>
                    </StackPanel>
                </Border>
                <Border Style="{StaticResource StatCard}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="💾" FontSize="14" VerticalAlignment="Center" Margin="0,0,6,0"/>
                        <TextBlock Text="{Binding TotalSizeDisplay}" FontWeight="Bold" FontSize="14"
                                   Foreground="{StaticResource AccentGreen}" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <Border Style="{StaticResource StatCard}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🖼️" FontSize="14" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding ImageCount}" Foreground="{StaticResource AccentOrange}" 
                                   FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <Border Style="{StaticResource StatCard}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🔊" FontSize="14" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding AudioCount}" Foreground="{StaticResource AccentPurple}" 
                                   FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <Border Style="{StaticResource StatCard}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="🧊" FontSize="14" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding ModelCount}" Foreground="{StaticResource AccentBlue}" 
                                   FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <Border Style="{StaticResource StatCard}">
                    <StackPanel Orientation="Horizontal">
                        <TextBlock Text="⚙️" FontSize="14" VerticalAlignment="Center" Margin="0,0,4,0"/>
                        <TextBlock Text="{Binding ConfigCount}" Foreground="{StaticResource TextPrimary}" 
                                   FontWeight="Bold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </Border>

        <!-- main content section -->
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" MinWidth="400"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- asset list section -->
            <Border Grid.Column="0" Margin="8" Background="{StaticResource BgSecondary}" 
                    CornerRadius="8">
                <ListView ItemsSource="{Binding FilteredAssets}" 
                          SelectedItem="{Binding SelectedAsset}"
                          Background="Transparent" BorderThickness="0"
                          Foreground="{StaticResource TextPrimary}"
                          ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                    <ListView.View>
                        <GridView>
                            <GridViewColumn Header="" Width="35">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding CategoryIcon}" FontSize="16" 
                                                   HorizontalAlignment="Center"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Name" Width="220">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Name}" 
                                                   Foreground="#C0CAF5" FontSize="13"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Type" Width="60">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Extension}" 
                                                   Foreground="#565F89" FontSize="12"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Category" Width="80">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Category}" 
                                                   Foreground="#9ECE6A" FontSize="12"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Size" Width="80">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding FileSizeDisplay}" 
                                                   Foreground="#565F89" FontSize="12"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                            <GridViewColumn Header="Path" Width="280">
                                <GridViewColumn.CellTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding RelativePath}" 
                                                   Foreground="#565F89" FontSize="11"
                                                   TextTrimming="CharacterEllipsis"/>
                                    </DataTemplate>
                                </GridViewColumn.CellTemplate>
                            </GridViewColumn>
                        </GridView>
                    </ListView.View>
                </ListView>
            </Border>

            <!-- splitter -->
            <GridSplitter Grid.Column="1" Width="3" 
                          Background="{StaticResource BorderColor}"
                          HorizontalAlignment="Center" VerticalAlignment="Stretch"/>

            <!-- this would be for the righ hand side panel where the previews/details -->
            <Border Grid.Column="2" Margin="8" Background="{StaticResource BgSecondary}" 
                    CornerRadius="8" Padding="16">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        <TextBlock Text="Asset Details" FontSize="16" FontWeight="SemiBold"
                                   Foreground="{StaticResource AccentBlue}" Margin="0,0,0,12"/>

                        <!-- no selection message -->
                        <TextBlock Text="Select an asset from the list to view details"
                                   Foreground="{StaticResource TextSecondary}" FontSize="13"
                                   TextWrapping="Wrap" FontStyle="Italic"
                                   Visibility="{Binding IsAssetSelected, Converter={StaticResource BoolToVis}, 
                                               ConverterParameter=Inverse, FallbackValue=Visible}"/>

                        <!-- displaying the Details ie it will be visible when the asset is selected -->
                        <StackPanel Visibility="{Binding IsAssetSelected, Converter={StaticResource BoolToVis}}">

                            <!-- image preview secction -->
                            <Border Background="{StaticResource BgTertiary}" CornerRadius="6" 
                                    Padding="8" Margin="0,0,0,12"
                                    Visibility="{Binding IsImageAsset, Converter={StaticResource BoolToVis}}">
                                <Image Source="{Binding PreviewImagePath}" 
                                       MaxHeight="200" Stretch="Uniform"
                                       RenderOptions.BitmapScalingMode="HighQuality"/>
                            </Border>

                            <!-- section for the category icon and the name -->
                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <TextBlock Text="{Binding SelectedAsset.CategoryIcon}" 
                                           FontSize="28" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedAsset.Name}" FontSize="16" 
                                               FontWeight="Bold" Foreground="{StaticResource TextPrimary}"/>
                                    <TextBlock Text="{Binding SelectedAsset.Extension}" FontSize="12"
                                               Foreground="{StaticResource TextSecondary}"/>
                                </StackPanel>
                            </StackPanel>

                            <Border Background="{StaticResource BgTertiary}" CornerRadius="6" 
                                    Padding="12" Margin="0,0,0,8">
                                <StackPanel>
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Category" Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.Category}" 
                                                   Foreground="{StaticResource AccentGreen}" FontSize="12"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Size" Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.FileSizeDisplay}" 
                                                   Foreground="{StaticResource TextPrimary}" FontSize="12"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,6">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Modified" Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.DateModified, StringFormat={}{0:yyyy-MM-dd HH:mm}}" 
                                                   Foreground="{StaticResource TextPrimary}" FontSize="12"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Text="Path" Foreground="{StaticResource TextSecondary}" FontSize="12"/>
                                        <TextBlock Grid.Column="1" Text="{Binding SelectedAsset.RelativePath}" 
                                                   Foreground="{StaticResource TextPrimary}" FontSize="11"
                                                   TextWrapping="Wrap"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- tags -->
                            <TextBlock Text="Tags" FontSize="13" FontWeight="SemiBold"
                                       Foreground="{StaticResource TextSecondary}" Margin="0,8,0,6"/>
                            <ItemsControl ItemsSource="{Binding SelectedAsset.Tags}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{StaticResource BgTertiary}" 
                                                CornerRadius="4" Padding="8,3" Margin="0,0,4,4">
                                            <TextBlock Text="{Binding}" FontSize="11"
                                                       Foreground="{StaticResource AccentPurple}"/>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- This would be for the status bar section -->
        <Border Grid.Row="3" Background="{StaticResource BgSecondary}" 
                BorderBrush="{StaticResource BorderColor}" BorderThickness="0,1,0,0"
                Padding="12,6">
            <Grid>
                <TextBlock Text="{Binding StatusText}" 
                           Foreground="{StaticResource TextSecondary}" FontSize="12"
                           HorizontalAlignment="Left"/>
                <TextBlock Text="{Binding CurrentFolderPath}" 
                           Foreground="{StaticResource TextSecondary}" FontSize="11"
                           HorizontalAlignment="Right" TextTrimming="CharacterEllipsis"
                           MaxWidth="500"/>
            </Grid>
        </Border>
    </Grid>
</Window>